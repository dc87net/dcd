#!/usr/bin/env zsh

# Make sure there was a scriptlet specificed
[[ -z "$1" ]] && exit -100

installTo="$(defaults read /opt/script/config.plist installTo)"
source "$installTo/etc/colors.sh"

# Parse args
CMD="$1"; shift
ARGS="$*"
#log "C:<$CMD>\t A:<$ARGS>"; echo;  # DEBUG

# Check for 'special' commands
if [[ "$CMD" == "install" ]]; then
  log "${BMAGENTA}Special: ${CYAN}install: ${BCYAN}$2${NC}"

  [[ "$ARGS" == "common" ]] && bash "$installTo/script/sh/install/brew-list.sh"

  exit 0
fi

# Run the scriptlet
(exec eval '/opt/script/bin/"$CMD" "$ARGS"')
